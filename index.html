<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Telegram 100% Clone</title>
    <style>
        :root {
            --bg: #0e1621; --dark: #17212b; --blue: #24A1DE;
            --msg-in: #182533; --msg-out: #2b5278; --text: #ffffff;
            --gray: #8e979e; --stars: #f9d949;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            margin: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: var(--bg); color: var(--text); height: 100vh; display: flex; flex-direction: column; overflow: hidden;
        }

        /* HEADER */
        header {
            background: var(--dark); padding: 10px 15px; display: flex; align-items: center;
            justify-content: space-between; border-bottom: 1px solid #232e3c; z-index: 10;
        }
        .user-meta { display: flex; align-items: center; gap: 12px; }
        .avatar { width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #62bbed, #24a1de); display: flex; align-items: center; justify-content: center; font-weight: bold; }
        .star-balance {
            background: rgba(249, 217, 73, 0.1); border: 1px solid var(--stars);
            padding: 5px 12px; border-radius: 20px; color: var(--stars); font-weight: bold; cursor: pointer;
        }

        /* SCREENS */
        .screen { display: none; flex: 1; overflow-y: auto; flex-direction: column; position: relative; }
        .active-screen { display: flex; }

        /* CHAT VIEW */
        #chat-screen { background: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png'); background-size: cover; background-blend-mode: overlay; }
        #messages-container { flex: 1; padding: 15px; display: flex; flex-direction: column; overflow-y: auto; }
        .bubble { 
            max-width: 80%; padding: 8px 12px; border-radius: 12px; margin-bottom: 8px; font-size: 15px; line-height: 1.4;
            position: relative; animation: slideIn 0.2s ease;
        }
        .bubble.in { background: var(--msg-in); align-self: flex-start; border-bottom-left-radius: 4px; }
        .bubble.out { background: var(--msg-out); align-self: flex-end; border-bottom-right-radius: 4px; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* VOICE PLAYER */
        .voice-msg { display: flex; align-items: center; gap: 10px; min-width: 160px; }
        .play-btn { width: 32px; height: 32px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--msg-out); cursor: pointer; }
        .progress-container { flex: 1; height: 3px; background: rgba(255,255,255,0.2); position: relative; }
        .progress-bar { height: 100%; background: white; width: 0%; }

        /* INPUT AREA */
        .input-bar { background: var(--dark); padding: 10px; display: flex; align-items: center; gap: 10px; }
        .input-bar input { flex: 1; background: var(--bg); border: none; padding: 10px 15px; border-radius: 20px; color: white; outline: none; }
        .mic-btn { font-size: 24px; cursor: pointer; transition: 0.2s; color: var(--blue); border: none; background: none; }
        .mic-btn.recording { color: #f44336; transform: scale(1.3); animation: pulse 1s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

        /* PROFILE */
        .profile-hero { background: var(--dark); padding: 30px 20px; text-align: center; }
        .profile-avatar-big { width: 90px; height: 90px; background: linear-gradient(135deg, #ef7cc7, #9e59eb); border-radius: 50%; margin: 0 auto 15px; display: flex; align-items: center; justify-content: center; font-size: 36px; }
        .gifts-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 15px; }
        .gift-slot { background: var(--dark); border-radius: 12px; padding: 10px; text-align: center; border: 1px solid #232e3c; }
        .gift-slot img { width: 100%; aspect-ratio: 1; object-fit: contain; }

        /* STORE MODAL */
        #store { 
            position: fixed; bottom: -100%; left: 0; width: 100%; height: 75%; background: var(--dark); 
            z-index: 100; border-radius: 20px 20px 0 0; transition: 0.4s cubic-bezier(0.1, 0.7, 0.1, 1); padding: 20px;
        }
        .store-item { background: var(--bg); border-radius: 15px; padding: 15px; text-align: center; border: 1px solid #333; cursor: pointer; }

        /* NAV TAB BAR */
        nav { background: var(--dark); display: flex; border-top: 1px solid #232e3c; padding: 8px 0; }
        .nav-tab { flex: 1; display: flex; flex-direction: column; align-items: center; color: var(--gray); font-size: 11px; gap: 4px; cursor: pointer; }
        .nav-tab.active { color: var(--blue); }

        .hidden { display: none; }
    </style>
</head>
<body>

<header>
    <div class="user-meta">
        <div class="avatar">G</div>
        <div>
            <div style="font-weight: 600;" id="header-name">Gemini Chat</div>
            <div style="font-size: 12px; color: var(--blue);" id="header-status">online</div>
        </div>
    </div>
    <div class="star-balance" onclick="earnStars()">‚≠ê <span id="star-count">1000</span></div>
</header>

<div id="chat-screen" class="screen active-screen">
    <div id="messages-container">
        <div class="bubble in">–ü—Ä–∏–≤–µ—Ç! –≠—Ç–æ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–ø–∏—Å–∞—Ç—å –≥–æ–ª–æ—Å –∏ –∫—É–ø–∏—Ç—å –ø–æ–¥–∞—Ä–∫–∏!</div>
    </div>
    <div class="input-bar">
        <div style="font-size: 24px; cursor: pointer;" onclick="openStore()">üéÅ</div>
        <input type="text" id="text-input" placeholder="Message">
        <button id="mic-btn" class="mic-btn">üé§</button>
    </div>
</div>

<div id="profile-screen" class="screen">
    <div class="profile-hero">
        <div class="profile-avatar-big">üòé</div>
        <h2 style="margin: 5px 0;">Developer Mode</h2>
        <p style="color: var(--gray);">@ai_master_clone</p>
    </div>
    <div style="padding: 15px 15px 0; color: var(--gray); font-size: 13px; font-weight: bold;">MY GIFTS (<span id="gift-stat">0</span>)</div>
    <div class="gifts-grid" id="profile-gifts">
        </div>
</div>

<div id="store">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h3 style="margin:0">Premium Gifts</h3>
        <span onclick="closeStore()" style="cursor:pointer; font-size: 20px;">‚úï</span>
    </div>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
        <div class="store-item" onclick="buyGift('Golden Star', 500, 'https://cdn-icons-png.flaticon.com/512/1828/1828884.png')">
            <img src="https://cdn-icons-png.flaticon.com/512/1828/1828884.png" width="60">
            <p>Star NFT</p><b style="color: var(--stars)">500 ‚≠ê</b>
        </div>
        <div class="store-item" onclick="buyGift('Rocket', 2500, 'https://cdn-icons-png.flaticon.com/512/1356/1356479.png')">
            <img src="https://cdn-icons-png.flaticon.com/512/1356/1356479.png" width="60">
            <p>Rocket</p><b style="color: var(--stars)">2.5k ‚≠ê</b>
        </div>
        <div class="store-item" onclick="buyGift('Diamond', 5000, 'https://cdn-icons-png.flaticon.com/512/3039/3039433.png')">
            <img src="https://cdn-icons-png.flaticon.com/512/3039/3039433.png" width="60">
            <p>Gem</p><b style="color: var(--stars)">5k ‚≠ê</b>
        </div>
    </div>
</div>

<nav>
    <div class="nav-tab active" onclick="navTo('chat', this)">
        <span>üí¨</span><span>Chats</span>
    </div>
    <div class="nav-tab" onclick="navTo('profile', this)">
        <span>üë§</span><span>Profile</span>
    </div>
</nav>

<script>
    let stars = 1000;
    let gifts = [];
    let mediaRecorder;
    let audioChunks = [];
    let isRecording = false;

    // –°–ò–°–¢–ï–ú–ê –ó–í–ï–ó–î
    function earnStars() {
        stars += 5000;
        document.getElementById('star-count').innerText = stars;
        sfx(800);
    }

    // –ù–ê–í–ò–ì–ê–¶–ò–Ø
    function navTo(screen, el) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
        document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
        document.getElementById(screen + '-screen').classList.add('active-screen');
        el.classList.add('active');
        document.getElementById('header-name').innerText = screen === 'chat' ? 'Gemini Chat' : 'My Profile';
    }

    // –ú–ê–ì–ê–ó–ò–ù
    function openStore() { document.getElementById('store').style.bottom = '0'; }
    function closeStore() { document.getElementById('store').style.bottom = '-100%'; }

    function buyGift(name, price, img) {
        if (stars < price) return alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤–µ–∑–¥!");
        stars -= price;
        document.getElementById('star-count').innerText = stars;
        gifts.push({name, img});
        
        // –í —á–∞—Ç
        const container = document.getElementById('messages-container');
        const giftBubble = document.createElement('div');
        giftBubble.className = 'bubble out';
        giftBubble.style.textAlign = 'center';
        giftBubble.innerHTML = `<img src="${img}" width="80"><br><b>${name}</b>`;
        container.appendChild(giftBubble);
        container.scrollTop = container.scrollHeight;

        // –í –ø—Ä–æ—Ñ–∏–ª—å
        updateProfile();
        closeStore();
    }

    function updateProfile() {
        const grid = document.getElementById('profile-gifts');
        grid.innerHTML = '';
        gifts.forEach(g => {
            grid.innerHTML += `<div class="gift-slot"><img src="${g.img}"><div style="font-size:10px; margin-top:5px;">${g.name}</div></div>`;
        });
        document.getElementById('gift-stat').innerText = gifts.length;
    }

    // –ì–û–õ–û–°–û–í–´–ï (MediaRecorder API)
    const micBtn = document.getElementById('mic-btn');
    micBtn.onmousedown = micBtn.ontouchstart = async (e) => {
        e.preventDefault();
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
            mediaRecorder = new MediaRecorder(stream);
            audioChunks = [];
            mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
            mediaRecorder.onstop = saveVoice;
            mediaRecorder.start();
            isRecording = true;
            micBtn.classList.add('recording');
        } catch(err) { alert("–ú–∏–∫—Ä–æ—Ñ–æ–Ω –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"); }
    };

    micBtn.onmouseup = micBtn.ontouchend = () => {
        if(isRecording) {
            mediaRecorder.stop();
            isRecording = false;
            micBtn.classList.remove('recording');
        }
    };

    function saveVoice() {
        const blob = new Blob(audioChunks, { type: 'audio/mp3' });
        const url = URL.createObjectURL(blob);
        const container = document.getElementById('messages-container');
        const id = Date.now();
        
        const bubble = document.createElement('div');
        bubble.className = 'bubble out';
        bubble.innerHTML = `
            <div class="voice-msg">
                <div class="play-btn" onclick="playAudio('${url}', this, ${id})">‚ñ∂</div>
                <div class="progress-container"><div class="progress-bar" id="pb-${id}"></div></div>
            </div>`;
        container.appendChild(bubble);
        container.scrollTop = container.scrollHeight;
    }

    function playAudio(url, btn, id) {
        const audio = new Audio(url);
        const pb = document.getElementById('pb-' + id);
        if(btn.innerText === '‚ñ∂') {
            audio.play();
            btn.innerText = 'II';
            audio.ontimeupdate = () => pb.style.width = (audio.currentTime/audio.duration)*100 + '%';
            audio.onended = () => { btn.innerText = '‚ñ∂'; pb.style.width = '0%'; };
        }
    }

    // –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
    document.getElementById('text-input').onkeypress = (e) => {
        if(e.key === 'Enter' && e.target.value.trim() !== "") {
            const container = document.getElementById('messages-container');
            const b = document.createElement('div');
            b.className = 'bubble out';
            b.innerText = e.target.value;
            container.appendChild(b);
            e.target.value = "";
            container.scrollTop = container.scrollHeight;
        }
    };

    // –ü—Ä–æ—Å—Ç–æ–π –∑–≤—É–∫
    function sfx(f) {
        const ctx = new AudioContext();
        const o = ctx.createOscillator();
        const g = ctx.createGain();
        o.frequency.value = f;
        g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.5);
        o.connect(g); g.connect(ctx.destination);
        o.start(); o.stop(ctx.currentTime + 0.5);
    }
</script>
</body>
</html>
